stages:
 - build

Horizon:Build-Prod:
  rules:
    - if: '$CI_COMMIT_BRANCH == "master"'
  image: registry.internal.st/dual-universe/dubuild:latest
  stage: build
  variables:
    GIT_SUBMODULE_STRATEGY: recursive
  script:
    - dotnet /app/DUBuild.dll build -s $CI_PROJECT_DIR -o $CI_PROJECT_DIR/output -e $CI_PROJECT_DIR/UnitTests -m "$CI_PROJECT_DIR/main_*.lua"
  artifacts:
      paths:
        - $CI_PROJECT_DIR/output/*.json
